BANK & CCP MODEL SPECIFICATIONS
===============================

This document describes the inputs and outputs for the trained models.

IMPORTANT: SCALING REQUIREMENT
------------------------------
The Bank and CCP models expect normalized input features. During training, a `StandardScaler` from `sklearn.preprocessing` is used.
If you use these models in a backend, you MUST apply the same scaling transformation to your inputs.
The scaler is fit on the following columns from `phase1_engineered_data.csv`:
['Total_Assets', 'Equity', 'HQLA', 'Net_Outflows_30d', 'Interbank_Liabilities']


1. BANK POLICY MODELS (`bank_policies.pkl`)
-------------------------------------------
Format: A dictionary `{ "BankName": MLPRegressor_Object }`.
Each bank has its own independent model.

### INPUTS (Feature Vector Size: 5)
The model takes a numpy array of shape (1, 5).
The 5 features are (in order):
1. Total Assets (Scaled)
2. Equity (Scaled)
3. HQLA (High Quality Liquid Assets) (Scaled)
4. Net Outflows 30d (Scaled)
5. Interbank Liabilities (Total exposure to other banks) (Scaled)

### OUTPUTS (Q-Values Vector Size: 9)
The model outputs Q-values for 9 possible actions. Select the index with the highest value (`argmax`).

Mapping (Index -> Action):
- 0: BUY (Small Size: 1% of HQLA)
- 1: SELL (Small Size)
- 2: HOLD (No Trade)
- 3: BUY (Medium Size: 5% of HQLA)
- 4: SELL (Medium Size)
- 5: HOLD (No Trade)
- 6: BUY (Large Size: 10% of HQLA)
- 7: SELL (Large Size)
- 8: HOLD (No Trade)

Formally:
- Index `i` corresponds to:
  - Size Index: `i // 3` (0=1%, 1=5%, 2=10%)
  - Direction Index: `i % 3` (0=BUY, 1=SELL, 2=HOLD)


2. CCP POLICY MODEL (`ccp_policy.pkl`)
--------------------------------------
Format: A single `MLPRegressor` object.

### INPUTS (Feature Vector Size: 8)
The model takes a numpy array of shape (1, 8).
The first 5 features are the SAME as the requesting Bank's scaled features.

1. Bank Total Assets (Scaled)
2. Bank Equity (Scaled)
3. Bank HQLA (Scaled)
4. Bank Net Outflows 30d (Scaled)
5. Bank Interbank Liabilities (Scaled)
--- Additional Transaction Features ---
6. Trade Size (Absolute Value, raw number)
7. Predicted Risk (Size * Volatility * Crash Severity)
8. Direction (1.0 for BUY, 0.0 for SELL)

### OUTPUTS (Q-Values Vector Size: 6)
The model outputs Q-values for 6 possible decisions. Select the index with the highest value.

Mapping (Index -> Decision):
- 0: Approve with 5% Margin
- 1: Approve with 10% Margin
- 2: Approve with 20% Margin
- 3: Approve with 30% Margin
- 4: Approve with 50% Margin
- 5: REJECT TRADE (Requires 100% Margin / No Trade)

3. IMPLEMENTATION NOTE (For Backend)
------------------------------------
To replicate the scaler in your backend:
1. Load `phase1_engineered_data.csv`.
2. Extract columns: `['Total_Assets', 'Equity', 'HQLA', 'Net_Outflows_30d', 'Interbank_Liabilities']`.
3. Fit a `StandardScaler` to this data.
4. Use this scaler to `transform` new bank states before feeding them to the models.
